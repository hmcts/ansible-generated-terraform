---

# (tasks/1-location.yml)
locations:
  - "uksouth"

keyvaults:
  - management

vnet_peerings:
  - management

subscriptions:
  mgmt: "examplem-anag-ment-azur-esubscriptid"

# (tasks/2-product.yml)
products:
  - molecule

# legacy products (don't set up network etc for these)
legacy:
  - molecule

# (tasks/3-environment.yml)
environments:
  molecule:
    - dev

# seems to only be used for keyvault, should potentially come from env var?
azure_tenant_id: "example-tenant-id"

# state file storage location
state_rg: "exampleRG"
state_storage_container_name: "statefiles"

domain: ".reform.hmcts.net"

environments_azure_subscription_ids:
  management: "examplem-anag-ment-azur-esubscriptid"
  molecule:
    dev: "exampled-evel-opmt-azur-esubscriptid"

output_folder: "ansible-generated"


default_server_vars: &default_server_vars
  size: "Standard_DS2_v2"
  count: 2

mgmt_default_server_vars: &mgmt_default_server_vars
  size: "Standard_DS2_v2"
  dev: false
  blobstore_s: false
  dmz: false
  os: linux

server_defaults: &server_defaults
  env_tag: dev
  count: 2

servers:
  molecule:
    dev:
      - name: web
        <<: *server_defaults
        role_tag: frontend
      - name: webpl
        <<: *server_defaults
        role_tag: frontend-pl
      - name: app
        <<: *server_defaults
        role_tag: backend
      - name: cache
        <<: *server_defaults
        count: 1
        role_tag: redis
      - name: data
        <<: *server_defaults
        additional_disk_size_gb: "512"
        count: 1

default_web_apps_vars: &default_web_apps_vars
  tier: "Standard"
  size: "S1"
  capacity: "0"
  kind: "linux"

# need to think about this, when we are building old and new systems
ip_ranges:
  dev:
    address_space: "172.0.0.1/24"
    unassigned1: "172.0.1.1/24"
    unassigned2: "172.0.2.1/24"
    docker: "172.0.3.1/24"
    app: "172.0.4.1/24"
    data: "172.0.5.1/24"

storage_account_tier: "Standard"
storage_account_replication_type: "LRS"

# prod jenkins key:
ssh_key: "<long_ssh_public_key>"

template_warning: "GENERATED BY ANSIBLE, DO NOT EDIT DIRECTLY"

# maps for legacy networks
vnet_map:
  dev: "exampleVNet"

vnet_rg_map:
  dev: "exampleRG"

subnet_prefix_map:
  dev: "exampleDevSN"

key_write: &key_write
  key_permissions:
     - "backup"
     - "create"
     - "decrypt"
     - "delete"
     - "encrypt"
     - "get"
     - "import"
     - "list"
     - "purge"
     - "recover"
     - "restore"
     - "sign"
     - "unwrapKey"
     - "update"
     - "verify"
     - "wrapKey"
sec_write: &sec_write
  secret_permissions:
     - "backup"
     - "delete"
     - "get"
     - "list"
     - "purge"
     - "recover"
     - "restore"
     - "set"

key_read: &key_read
  key_permissions:
     - "get"
     - "list"
sec_read: &sec_read
  secret_permissions:
     - "get"
     - "list"

key_vault_permissions:
  # max of 16 users, as per TF docs :/
  # just an example user for now:
  dev:
    dcd_dev_jenkins:
      object_id: "<OID>"
      <<: *key_read
      <<: *sec_read
  mgmt:
    dcd_devops_jenkins:
      object_id: "<OID>"
      <<: *key_write
      <<: *sec_write

# not used yet
destroy_nightly:
  fridam:
    - dev
    - sandbox
  cmc:
    - demo

role_path: "{{ playbook_dir }}"

mgmt_servers:
  sometestbox:
    size: "Standard_DS3_v2"
    dev: true
    role_tag: "sometestrole"
    additional_disk_size_gb: "1024"
